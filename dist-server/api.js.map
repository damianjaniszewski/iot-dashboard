{"version":3,"sources":["../server/api.js"],"names":["router","Router","post","req","res","body","email","password","statusMessage","status","end","name","split","replace","now","Date","token","v4","session","json","get","query","then","events","sensors","params","id","result","sensor","delete","undefined","module","exports"],"mappings":";;AAAA;;;;AACA;;AACA;;;;;;AAEA,IAAMA,SAAS,kBAAQC,MAAR,EAAf;;AAEAD,OAAOE,IAAP,CAAY,WAAZ,EAAyB,UAACC,GAAD,EAAMC,GAAN,EAAc;AAAA,kBACTD,IAAIE,IADK;AAAA,MAC7BC,KAD6B,aAC7BA,KAD6B;AAAA,MACtBC,QADsB,aACtBA,QADsB;;AAErC,MAAI,CAACD,KAAD,IAAU,CAACC,QAAX,IAAuBD,UAAU,OAArC,EAA8C;AAC5CF,QAAII,aAAJ,GAAoB,2BAApB;AACAJ,QAAIK,MAAJ,CAAW,GAAX,EAAgBC,GAAhB;AACD,GAHD,MAGO;AACL,QAAMC,OAAOL,MAAMM,KAAN,CAAY,GAAZ,EAAiB,CAAjB,EAAoBC,OAApB,CAA4B,MAA5B,EAAoC,GAApC,CAAb,CADK,CACkD;AACvD,QAAMC,MAAM,IAAIC,IAAJ,EAAZ;AACA,QAAMC,mBAAiB,eAAKC,EAAL,EAAvB;AACA,QAAMC,UAAU,EAAEZ,YAAF,EAASK,UAAT,EAAeK,YAAf,EAAhB;AACA,0BAAWA,KAAX,EAAkBE,OAAlB;AACAd,QAAIe,IAAJ,CAASD,OAAT;AACD;AACF,CAbD;;AAeAlB,OAAOoB,GAAP,CAAW,SAAX,EAAsB,UAACjB,GAAD,EAAMC,GAAN,EAAc;AAClC,uBAAUD,IAAIkB,KAAd,EAAqBC,IAArB,CAA0B;AAAA,WAAUlB,IAAIe,IAAJ,CAASI,MAAT,CAAV;AAAA,GAA1B;AACD,CAFD;;AAIAvB,OAAOoB,GAAP,CAAW,UAAX,EAAuB,UAACjB,GAAD,EAAMC,GAAN,EAAc;AACnC,wBAAWD,IAAIkB,KAAf,EAAsBC,IAAtB,CAA2B;AAAA,WAAWlB,IAAIe,IAAJ,CAASK,OAAT,CAAX;AAAA,GAA3B;AACD,CAFD;;AAIAxB,OAAOoB,GAAP,CAAW,aAAX,EAA0B,UAACjB,GAAD,EAAMC,GAAN,EAAc;AACtC,uBAAUD,IAAIsB,MAAJ,CAAWC,EAArB,EAAyBJ,IAAzB,CAA8B,UAACK,MAAD,EAAY;AACxC,QAAI,CAACA,OAAOC,MAAZ,EAAoB;AAClBxB,UAAIK,MAAJ,CAAW,GAAX,EAAgBC,GAAhB;AACD,KAFD,MAEO;AACLN,UAAIe,IAAJ,CAASQ,MAAT;AACD;AACF,GAND;AAOD,CARD;;AAUA3B,OAAO6B,MAAP,CAAc,aAAd,EAA6B,UAAC1B,GAAD,EAAMC,GAAN,EAAc;AACzCA,MAAIe,IAAJ,CAASW,SAAT;AACD,CAFD;;AAIAC,OAAOC,OAAP,GAAiBhC,MAAjB","file":"api.js","sourcesContent":["import express from 'express';\nimport { addSession, getEvents, getSensors, getSensor} from './data';\nimport uuid from 'uuid';\n\nconst router = express.Router();\n\nrouter.post('/sessions', (req, res) => {\n  const { email, password } = req.body;\n  if (!email || !password || email === 'error') {\n    res.statusMessage = 'Invalid email or password';\n    res.status(401).end();\n  } else {\n    const name = email.split('@')[0].replace(/\\.|_/, ' '); // simulated\n    const now = new Date();\n    const token = `token-${uuid.v4()}`;\n    const session = { email, name, token };\n    addSession(token, session);\n    res.json(session);\n  }\n});\n\nrouter.get('/events', (req, res) => {\n  getEvents(req.query).then(events => res.json(events));\n});\n\nrouter.get('/sensors', (req, res) => {\n  getSensors(req.query).then(sensors => res.json(sensors));\n});\n\nrouter.get('/sensor/:id', (req, res) => {\n  getSensor(req.params.id).then((result) => {\n    if (!result.sensor) {\n      res.status(404).end();\n    } else {\n      res.json(result);\n    }\n  });\n});\n\nrouter.delete('/sessions/*', (req, res) => {\n  res.json(undefined);\n});\n\nmodule.exports = router;\n"]}